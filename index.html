<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoPartMatcher - Smart Car Parts Compatibility Checker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-size: 2.8rem;
            font-weight: bold;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            color: var(--primary);
        }

        .tagline {
            color: var(--gray);
            font-size: 1.2rem;
        }

        .user-actions {
            display: flex;
            gap: 15px;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 25px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
        }

        .nav-tab:hover:not(.active) {
            background: var(--light);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary);
        }

        select, input, textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .btn {
            background: var(--primary);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .btn-block {
            width: 100%;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #219653;
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: var(--gray);
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .results {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid var(--primary);
        }

        .compatibility-badge {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .compatible {
            background: #d4edda;
            color: #155724;
        }

        .not-compatible {
            background: #f8d7da;
            color: #721c24;
        }

        .requires-modification {
            background: #fff3cd;
            color: #856404;
        }

        .part-card {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            background: white;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
        }

        .part-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .part-card h4 {
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .price {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--success);
            margin: 10px 0;
        }

        .part-meta {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .part-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .part-actions .btn {
            flex: 1;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            padding: 25px 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .feature-card h3 {
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            color: white;
            padding: 30px 20px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .saved-vehicles {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .saved-vehicle {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .saved-vehicle:hover {
            background: #dde4e6;
        }

        .saved-vehicle i {
            cursor: pointer;
            color: var(--danger);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .comparison-table th {
            background: var(--light);
            font-weight: 600;
        }

        .comparison-table tr:hover {
            background: #f5f5f5;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.warning {
            background: var(--warning);
        }

        .tab-subnav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-subnav button {
            padding: 10px 20px;
            background: var(--light);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-subnav button.active {
            background: var(--primary);
            color: white;
        }

        .part-image {
            width: 100%;
            height: 180px;
            background: var(--light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            color: var(--gray);
        }

        .rating {
            color: var(--warning);
            margin: 5px 0;
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress {
            height: 100%;
            background: var(--success);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .cart-items {
            margin: 20px 0;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .cart-total {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: right;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .maintenance-item {
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .search-suggestions {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: calc(100% - 2px);
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .suggestion-item:hover {
            background: #f5f5f5;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <!-- Shopping Cart Modal -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <h2><i class="fas fa-shopping-cart"></i> Shopping Cart</h2>
            <div class="cart-items" id="cartItems">
                <!-- Cart items will be populated here -->
            </div>
            <div class="cart-total" id="cartTotal">Total: $0.00</div>
            <div class="part-actions">
                <button class="btn btn-success" onclick="checkout()">
                    <i class="fas fa-credit-card"></i> Checkout
                </button>
                <button class="btn btn-secondary" onclick="closeModal('cartModal')">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Part Details Modal -->
    <div class="modal" id="partDetailsModal">
        <div class="modal-content">
            <h2 id="partDetailsTitle"><i class="fas fa-info-circle"></i> Part Details</h2>
            <div id="partDetailsContent">
                <!-- Part details will be populated here -->
            </div>
            <div class="part-actions" style="margin-top: 20px;">
                <button class="btn btn-success" id="addToCartFromDetails">
                    <i class="fas fa-cart-plus"></i> Add to Cart
                </button>
                <button class="btn btn-secondary" onclick="closeModal('partDetailsModal')">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Add Vehicle Modal -->
    <div class="modal" id="addVehicleModal">
        <div class="modal-content">
            <h2><i class="fas fa-plus"></i> Add New Vehicle</h2>
            <div class="form-group">
                <label for="newVehicleYear">Year</label>
                <select id="newVehicleYear">
                    <option value="">Select Year</option>
                </select>
            </div>
            <div class="form-group">
                <label for="newVehicleMake">Make</label>
                <input type="text" id="newVehicleMake" placeholder="e.g., Toyota">
            </div>
            <div class="form-group">
                <label for="newVehicleModel">Model</label>
                <input type="text" id="newVehicleModel" placeholder="e.g., Camry">
            </div>
            <div class="form-group">
                <label for="newVehicleTrim">Trim (Optional)</label>
                <input type="text" id="newVehicleTrim" placeholder="e.g., LE">
            </div>
            <div class="part-actions">
                <button class="btn" onclick="saveNewVehicle()">
                    <i class="fas fa-save"></i> Save Vehicle
                </button>
                <button class="btn btn-secondary" onclick="closeModal('addVehicleModal')">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-car"></i>
                    AutoPartMatcher
                </div>
                <div class="tagline">Find guaranteed compatible parts for your vehicle</div>
            </div>
            <div class="user-actions">
                <button class="btn btn-secondary" id="loginBtn">
                    <i class="fas fa-user"></i> Sign In
                </button>
                <button class="btn" id="registerBtn">
                    <i class="fas fa-user-plus"></i> Register
                </button>
                <button class="btn btn-warning" id="cartBtn">
                    <i class="fas fa-shopping-cart"></i> Cart (<span id="cartCount">0</span>)
                </button>
            </div>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="compatibility">
                <i class="fas fa-search"></i> Part Finder
            </button>
            <button class="nav-tab" data-tab="vin-decoder">
                <i class="fas fa-barcode"></i> VIN Decoder
            </button>
            <button class="nav-tab" data-tab="cross-reference">
                <i class="fas fa-exchange-alt"></i> Cross Reference
            </button>
            <button class="nav-tab" data-tab="maintenance">
                <i class="fas fa-tools"></i> Maintenance Tracker
            </button>
            <button class="nav-tab" data-tab="saved">
                <i class="fas fa-bookmark"></i> Saved Vehicles
            </button>
        </div>

        <!-- Part Finder Tab -->
        <div class="tab-content active" id="compatibility">
            <div class="main-grid">
                <div class="card">
                    <h2><i class="fas fa-search"></i> Find Compatible Parts</h2>
                    <form id="compatibilityForm">
                        <div class="form-group">
                            <label for="vehicleYear">Vehicle Year</label>
                            <select id="vehicleYear" required>
                                <option value="">Select Year</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="vehicleMake">Make</label>
                            <select id="vehicleMake" required disabled>
                                <option value="">Select Make</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="vehicleModel">Model</label>
                            <select id="vehicleModel" required disabled>
                                <option value="">Select Model</option>
                            <option value="custom">Custom Model</option>
                            </select>
                        </div>

                        <div class="form-group" id="customModelGroup" style="display: none;">
                            <label for="customModel">Enter Model Name</label>
                            <input type="text" id="customModel" placeholder="Enter your vehicle model">
                        </div>

                        <div class="form-group">
                            <label for="vehicleTrim">Trim (Optional)</label>
                            <select id="vehicleTrim" disabled>
                                <option value="">Select Trim</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="partCategory">Part Category</label>
                            <select id="partCategory" required>
                                <option value="">Select Category</option>
                                <option value="engine">Engine Parts</option>
                                <option value="brakes">Brakes & Rotors</option>
                                <option value="suspension">Suspension</option>
                                <option value="electrical">Electrical</option>
                                <option value="exhaust">Exhaust System</option>
                                <option value="transmission">Transmission</option>
                                <option value="cooling">Cooling System</option>
                                <option value="filters">Filters</option>
                                <option value="lighting">Lighting</option>
                                <option value="interior">Interior</option>
                                <option value="exterior">Exterior</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="partNumber">Part Number or Name (Optional)</label>
                            <input type="text" id="partNumber" placeholder="e.g., OF-123 or 'Oil Filter'">
                            <div class="search-suggestions" id="partSuggestions"></div>
                        </div>

                        <button type="submit" class="btn btn-block">
                            <i class="fas fa-search"></i> Find Compatible Parts
                        </button>
                    </form>

                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p>Searching our database for compatible parts...</p>
                    </div>

                    <div class="results" id="results">
                        <!-- Results will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-info-circle"></i> How It Works</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-car"></i></div>
                            <h3>Select Your Vehicle</h3>
                            <p>Choose your car's year, make, model, and trim for precise compatibility</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-cogs"></i></div>
                            <h3>Choose Parts</h3>
                            <p>Browse by category or search by specific part number</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-check-circle"></i></div>
                            <h3>Guaranteed Fit</h3>
                            <p>We verify compatibility across thousands of parts</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon"><i class="fas fa-shopping-cart"></i></div>
                            <h3>Shop with Confidence</h3>
                            <p>Direct links to trusted suppliers with best prices</p>
                        </div>
                    </div>

                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-number">250K+</div>
                            <div class="stat-label">Parts in Database</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">95%</div>
                            <div class="stat-label">Accuracy Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">50K+</div>
                            <div class="stat-label">Happy Users</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3>Quick Actions</h3>
                        <button class="btn btn-secondary btn-block" style="margin-bottom: 10px;" onclick="switchTab('vin-decoder')">
                            <i class="fas fa-barcode"></i> Decode VIN
                        </button>
                        <button class="btn btn-secondary btn-block" style="margin-bottom: 10px;" onclick="switchTab('cross-reference')">
                            <i class="fas fa-exchange-alt"></i> Cross Reference Part
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="switchTab('maintenance')">
                            <i class="fas fa-tools"></i> Track Maintenance
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIN Decoder Tab -->
        <div class="tab-content" id="vin-decoder">
            <div class="card">
                <h2><i class="fas fa-barcode"></i> VIN Decoder</h2>
                <p>Enter your Vehicle Identification Number to automatically detect your vehicle details.</p>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="vinInput">Vehicle Identification Number (VIN)</label>
                    <input type="text" id="vinInput" placeholder="e.g., 1HGCM82633A123456" maxlength="17">
                </div>
                
                <button class="btn" onclick="decodeVIN()">
                    <i class="fas fa-search"></i> Decode VIN
                </button>
                
                <div class="results" id="vinResults" style="display: none; margin-top: 20px;">
                    <!-- VIN results will be populated here -->
                </div>
            </div>
        </div>

        <!-- Cross Reference Tab -->
        <div class="tab-content" id="cross-reference">
            <div class="card">
                <h2><i class="fas fa-exchange-alt"></i> Part Number Cross Reference</h2>
                <p>Enter a part number to find equivalent parts from different manufacturers.</p>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="crossRefPartNumber">Part Number</label>
                    <input type="text" id="crossRefPartNumber" placeholder="e.g., OF-123">
                </div>
                
                <div class="form-group">
                    <label for="crossRefBrand">Brand (Optional)</label>
                    <input type="text" id="crossRefBrand" placeholder="e.g., Bosch">
                </div>
                
                <button class="btn" onclick="findCrossReferences()">
                    <i class="fas fa-search"></i> Find Equivalent Parts
                </button>
                
                <div class="results" id="crossRefResults" style="display: none; margin-top: 20px;">
                    <!-- Cross reference results will be populated here -->
                </div>
            </div>
        </div>

        <!-- Maintenance Tracker Tab -->
        <div class="tab-content" id="maintenance">
            <div class="card">
                <h2><i class="fas fa-tools"></i> Maintenance Tracker</h2>
                <p>Track your vehicle's maintenance history and get reminders for upcoming services.</p>
                
                <div class="tab-subnav">
                    <button class="active" data-subtab="logMaintenance">Log Maintenance</button>
                    <button data-subtab="maintenanceHistory">View History</button>
                    <button data-subtab="upcomingServices">Upcoming Services</button>
                </div>
                
                <div id="logMaintenance" class="subtab-content">
                    <div class="form-group">
                        <label for="maintenanceVehicle">Select Vehicle</label>
                        <select id="maintenanceVehicle">
                            <option value="">Select a vehicle</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="maintenanceType">Maintenance Type</label>
                        <select id="maintenanceType">
                            <option value="oil">Oil Change</option>
                            <option value="tire">Tire Rotation</option>
                            <option value="brake">Brake Service</option>
                            <option value="filter">Filter Replacement</option>
                            <option value="inspection">Inspection</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="maintenanceDate">Date Performed</label>
                        <input type="date" id="maintenanceDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="maintenanceMileage">Mileage</label>
                        <input type="number" id="maintenanceMileage" placeholder="Current mileage">
                    </div>
                    
                    <div class="form-group">
                        <label for="maintenanceCost">Cost (Optional)</label>
                        <input type="number" id="maintenanceCost" placeholder="0.00" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="maintenanceNotes">Notes (Optional)</label>
                        <textarea id="maintenanceNotes" rows="3" placeholder="Any additional details..."></textarea>
                    </div>
                    
                    <button class="btn" onclick="logMaintenance()">
                        <i class="fas fa-save"></i> Log Maintenance
                    </button>
                </div>
                
                <div id="maintenanceHistory" class="subtab-content" style="display: none;">
                    <div id="maintenanceHistoryList">
                        <!-- Maintenance history will be populated here -->
                    </div>
                </div>
                
                <div id="upcomingServices" class="subtab-content" style="display: none;">
                    <div id="upcomingServicesList">
                        <!-- Upcoming services will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Saved Vehicles Tab -->
        <div class="tab-content" id="saved">
            <div class="card">
                <h2><i class="fas fa-bookmark"></i> Saved Vehicles</h2>
                <p>Manage your saved vehicles for quick part searches.</p>
                
                <div class="saved-vehicles" id="savedVehiclesList">
                    <!-- Saved vehicles will be populated here -->
                </div>
                
                <button class="btn" style="margin-top: 20px;" onclick="showModal('addVehicleModal')">
                    <i class="fas fa-plus"></i> Add New Vehicle
                </button>
            </div>
        </div>

        <footer>
            <div class="footer-links">
                <a href="#">About Us</a>
                <a href="#">Contact</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">FAQ</a>
                <a href="#">Support</a>
            </div>
            <p>&copy; 2024 AutoPartMatcher. The smart way to find car parts. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Enhanced vehicle data with more models and parts
        const vehicleData = {
            years: [2024, 2023, 2022, 2021, 2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013],
            makes: {
                2024: ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'BMW', 'Mercedes-Benz', 'Hyundai', 'Kia'],
                2023: ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'BMW', 'Mercedes-Benz', 'Nissan', 'Volkswagen'],
                2022: ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'BMW', 'Audi', 'Subaru', 'Mazda'],
                2021: ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'Nissan', 'Hyundai', 'Kia', 'Volkswagen'],
                2020: ['Toyota', 'Honda', 'Ford', 'Chevrolet', 'BMW', 'Mercedes-Benz', 'Audi', 'Lexus'],
                // More years would be added in a real application
            },
            models: {
                'Toyota': ['Camry', 'Corolla', 'RAV4', 'Highlander', 'Tacoma', '4Runner', 'Sienna', 'Prius'],
                'Honda': ['Civic', 'Accord', 'CR-V', 'Pilot', 'Odyssey', 'HR-V', 'Fit', 'Ridgeline'],
                'Ford': ['F-150', 'Explorer', 'Escape', 'Mustang', 'Focus', 'Edge', 'Ranger', 'Bronco'],
                'Chevrolet': ['Silverado', 'Equinox', 'Malibu', 'Traverse', 'Tahoe', 'Camaro', 'Colorado'],
                'BMW': ['3 Series', '5 Series', 'X3', 'X5', 'X1', '7 Series', 'X7', '4 Series'],
                'Mercedes-Benz': ['C-Class', 'E-Class', 'GLC', 'GLE', 'A-Class', 'S-Class', 'GLA'],
                // More makes would be added in a real application
            },
            trims: {
                'Camry': ['LE', 'SE', 'XLE', 'XSE', 'TRD', 'Nightshade'],
                'Civic': ['LX', 'EX', 'Touring', 'Si', 'Type R', 'Sport'],
                'F-150': ['XL', 'XLT', 'Lariat', 'King Ranch', 'Platinum', 'Limited', 'Raptor'],
                'Silverado': ['Work Truck', 'LT', 'RST', 'LTZ', 'High Country'],
                '3 Series': ['330i', '330i xDrive', 'M340i', 'M340i xDrive'],
                'C-Class': ['C 300', 'C 300 4MATIC', 'AMG C 43', 'AMG C 63'],
                // More models would be added in a real application
            }
        };

        // Enhanced parts database with more details
        const partsDatabase = {
            'engine': [
                { 
                    name: 'Premium Oil Filter', 
                    number: 'OF-123', 
                    brand: 'Bosch',
                    compatibleWith: ['Camry', 'Corolla', 'RAV4'], 
                    price: 12.99, 
                    fit: 'direct',
                    rating: 4.5,
                    reviews: 128,
                    description: 'High-quality oil filter with synthetic media for superior engine protection. Provides excellent filtration efficiency and durability.',
                    warranty: '1 year',
                    stock: 45,
                    specifications: {
                        'Thread Size': '20mm',
                        'Height': '3.5 inches',
                        'Bypass Valve': '12-17 PSI',
                        'Anti-Drain Back': 'Yes'
                    }
                },
                { 
                    name: 'Performance Air Filter', 
                    number: 'AF-456', 
                    brand: 'K&N',
                    compatibleWith: ['Civic', 'Accord', 'CR-V'], 
                    price: 42.99, 
                    fit: 'direct',
                    rating: 4.8,
                    reviews: 203,
                    description: 'Reusable air filter that increases airflow and horsepower. Washable and reusable for up to 50,000 miles.',
                    warranty: '10 years',
                    stock: 23,
                    specifications: {
                        'Filter Material': 'Cotton Gauze',
                        'Cleaning Interval': '50,000 miles',
                        'HP Increase': '1-4 HP',
                        'Reusable': 'Yes'
                    }
                },
                { 
                    name: 'Iridium Spark Plugs (Set of 4)', 
                    number: 'SP-789', 
                    brand: 'NGK',
                    compatibleWith: ['F-150', 'Explorer', 'Escape'], 
                    price: 38.99, 
                    fit: 'direct',
                    rating: 4.6,
                    reviews: 89,
                    description: 'Long-life iridium spark plugs for improved fuel efficiency and performance. Lasts up to 100,000 miles.',
                    warranty: '3 years',
                    stock: 67,
                    specifications: {
                        'Electrode Material': 'Iridium',
                        'Gap': '0.044 inches',
                        'Heat Range': '6',
                        'Life Expectancy': '100,000 miles'
                    }
                }
            ],
            'brakes': [
                { 
                    name: 'Ceramic Front Brake Pads', 
                    number: 'BP-111', 
                    brand: 'Akebono',
                    compatibleWith: ['Camry', 'RAV4', 'Highlander'], 
                    price: 65.99, 
                    fit: 'direct',
                    rating: 4.7,
                    reviews: 156,
                    description: 'Quiet, low-dust ceramic brake pads with excellent stopping power. Perfect for daily driving comfort.',
                    warranty: 'Lifetime',
                    stock: 34,
                    specifications: {
                        'Material': 'Ceramic',
                        'Wear Sensor': 'Included',
                        'Noise Level': 'Quiet',
                        'Dust Level': 'Low'
                    }
                },
                { 
                    name: 'Premium Rear Brake Rotors', 
                    number: 'BR-222', 
                    brand: 'Power Stop',
                    compatibleWith: ['Civic', 'CR-V', 'Accord'], 
                    price: 112.99, 
                    fit: 'modification',
                    rating: 4.3,
                    reviews: 72,
                    description: 'Drilled and slotted rotors for improved braking performance and heat dissipation. Requires adapter bracket for installation.',
                    warranty: '2 years',
                    stock: 18,
                    specifications: {
                        'Type': 'Drilled & Slotted',
                        'Diameter': '11.8 inches',
                        'Thickness': '0.86 inches',
                        'Vanes': 'Directional'
                    }
                },
                { 
                    name: 'Complete Brake Kit (Front & Rear)', 
                    number: 'BK-333', 
                    brand: 'ACDelco',
                    compatibleWith: ['F-150', 'Silverado'], 
                    price: 249.99, 
                    fit: 'direct',
                    rating: 4.9,
                    reviews: 45,
                    description: 'Complete brake system refresh kit including pads and rotors for all four wheels. Everything needed for a full brake job.',
                    warranty: '3 years',
                    stock: 12,
                    specifications: {
                        'Includes': 'Pads & Rotors (All 4)',
                        'Bed-In Coating': 'Pre-applied',
                        'Installation Time': '2-3 hours',
                        'Performance': 'OE Replacement'
                    }
                }
            ],
            'suspension': [
                { 
                    name: 'Quick-Strut Assembly (Front)', 
                    number: 'FS-444', 
                    brand: 'Monroe',
                    compatibleWith: ['Camry', 'Accord', 'Malibu'], 
                    price: 129.99, 
                    fit: 'direct',
                    rating: 4.4,
                    reviews: 93,
                    description: 'Complete strut assembly for easy installation - no spring compression needed. Pre-assembled and ready to install.',
                    warranty: 'Lifetime',
                    stock: 28,
                    specifications: {
                        'Type': 'Complete Strut',
                        'Spring Included': 'Yes',
                        'Installation': 'No spring compression',
                        'Mount Included': 'Yes'
                    }
                },
                { 
                    name: 'Performance Shock Absorbers (Pair)', 
                    number: 'SA-555', 
                    brand: 'Bilstein',
                    compatibleWith: ['RAV4', 'CR-V', 'Equinox'], 
                    price: 289.99, 
                    fit: 'not-compatible',
                    rating: 4.2,
                    reviews: 37,
                    description: 'High-performance gas shock absorbers for improved handling and ride comfort. Not compatible with air suspension systems.',
                    warranty: 'Limited lifetime',
                    stock: 8,
                    specifications: {
                        'Type': 'Gas Charged',
                        'Bore Size': '46mm',
                        'Technology': 'Monotube',
                        'Ride Height': 'Stock'
                    }
                }
            ],
            'filters': [
                { 
                    name: 'Premium Cabin Air Filter', 
                    number: 'CAF-777', 
                    brand: 'FRAM',
                    compatibleWith: ['Camry', 'Corolla', 'RAV4', 'Civic', 'Accord'], 
                    price: 24.99, 
                    fit: 'direct',
                    rating: 4.5,
                    reviews: 201,
                    description: 'Activated carbon cabin air filter that removes odors and allergens. Improves interior air quality.',
                    warranty: '1 year',
                    stock: 89,
                    specifications: {
                        'Media': 'Activated Carbon',
                        'Allergen Reduction': '99%',
                        'Odor Reduction': 'Yes',
                        'Change Interval': '15,000 miles'
                    }
                },
                { 
                    name: 'High-Capacity Fuel Filter', 
                    number: 'FF-888', 
                    brand: 'Motorcraft',
                    compatibleWith: ['F-150', 'Explorer', 'Escape'], 
                    price: 18.99, 
                    fit: 'direct',
                    rating: 4.6,
                    reviews: 64,
                    description: 'OEM-quality fuel filter with high dirt-holding capacity. Protects fuel injectors and pump.',
                    warranty: '2 years',
                    stock: 42,
                    specifications: {
                        'Filter Media': 'Synthetic',
                        'Micron Rating': '10 microns',
                        'Pressure Rating': '75 PSI',
                        'Connections': 'Quick-connect'
                    }
                }
            ]
        };

        // Cross-reference database
        const crossReferenceDB = {
            'OF-123': [
                { brand: 'Bosch', number: 'OF-123', price: '$12.99' },
                { brand: 'FRAM', number: 'PH3614', price: '$9.99' },
                { brand: 'Motorcraft', number: 'FL-910', price: '$11.49' },
                { brand: 'ACDelco', number: 'PF-1234', price: '$10.99' }
            ],
            'AF-456': [
                { brand: 'K&N', number: 'AF-456', price: '$42.99' },
                { brand: 'FRAM', number: 'CA-9482', price: '$18.99' },
                { brand: 'WIX', number: 'WA-1042', price: '$16.99' },
                { brand: 'Hengst', number: 'H-1234', price: '$22.99' }
            ],
            'BP-111': [
                { brand: 'Akebono', number: 'BP-111', price: '$65.99' },
                { brand: 'Wagner', number: 'BX-123', price: '$52.99' },
                { brand: 'Raybestos', number: 'R-456', price: '$58.99' },
                { brand: 'ACDelco', number: 'BP-789', price: '$61.99' }
            ]
        };

        // Application state
        let savedVehicles = JSON.parse(localStorage.getItem('savedVehicles')) || [];
        let maintenanceLogs = JSON.parse(localStorage.getItem('maintenanceLogs')) || [];
        let shoppingCart = JSON.parse(localStorage.getItem('shoppingCart')) || [];
        let currentVehicle = null;

        // DOM elements
        const notification = document.getElementById('notification');

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initializeYearDropdown();
            setupTabNavigation();
            setupSubTabNavigation();
            loadSavedVehicles();
            updateMaintenanceVehicleDropdown();
            updateCartCount();
            setupPartSearchSuggestions();
            
            // Set current date for maintenance form
            document.getElementById('maintenanceDate').valueAsDate = new Date();
            
            // Check for vehicle in URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const prefillVehicle = urlParams.get('vehicle');
            if (prefillVehicle) {
                const [year, make, model] = prefillVehicle.split('-');
                if (year && make && model) {
                    setTimeout(() => {
                        prefillVehicleForm(year, make, model);
                    }, 500);
                }
            }
        });

        function initializeYearDropdown() {
            const yearSelect = document.getElementById('vehicleYear');
            vehicleData.years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });
        }

        function setupTabNavigation() {
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
        }

        function setupSubTabNavigation() {
            const subtabs = document.querySelectorAll('.tab-subnav button');
            subtabs.forEach(button => {
                button.addEventListener('click', function() {
                    // Get parent tab content
                    const parentTab = this.closest('.tab-content');
                    const subtabId = this.getAttribute('data-subtab');
                    
                    // Hide all subtab contents in this tab
                    const subtabContents = parentTab.querySelectorAll('.subtab-content');
                    subtabContents.forEach(content => {
                        content.style.display = 'none';
                    });
                    
                    // Remove active class from all buttons in this tab
                    const allButtons = parentTab.querySelectorAll('.tab-subnav button');
                    allButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Activate clicked button
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const contentToShow = parentTab.querySelector(`#${subtabId}`);
                    if (contentToShow) {
                        contentToShow.style.display = 'block';
                        
                        // Load data for specific subtabs
                        if (subtabId === 'maintenanceHistory') {
                            loadMaintenanceHistory();
                        } else if (subtabId === 'upcomingServices') {
                            loadUpcomingServices();
                        }
                    }
                });
            });
        }

        function switchTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate selected tab
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.nav-tab[data-tab="${tabId}"]`).classList.add('active');
        }

        function setupPartSearchSuggestions() {
            const partNumberInput = document.getElementById('partNumber');
            const suggestionsContainer = document.getElementById('partSuggestions');
            
            partNumberInput.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                suggestionsContainer.innerHTML = '';
                
                if (query.length < 2) {
                    suggestionsContainer.style.display = 'none';
                    return;
                }
                
                // Collect all parts that match the query
                const matches = [];
                Object.keys(partsDatabase).forEach(category => {
                    partsDatabase[category].forEach(part => {
                        if (part.number.toLowerCase().includes(query) || 
                            part.name.toLowerCase().includes(query) ||
                            part.brand.toLowerCase().includes(query)) {
                            matches.push(part);
                        }
                    });
                });
                
                if (matches.length > 0) {
                    matches.slice(0, 5).forEach(part => {
                        const suggestion = document.createElement('div');
                        suggestion.className = 'suggestion-item';
                        suggestion.innerHTML = `
                            <strong>${part.number}</strong> - ${part.name} (${part.brand})
                        `;
                        suggestion.addEventListener('click', function() {
                            partNumberInput.value = part.number;
                            suggestionsContainer.style.display = 'none';
                        });
                        suggestionsContainer.appendChild(suggestion);
                    });
                    suggestionsContainer.style.display = 'block';
                } else {
                    suggestionsContainer.style.display = 'none';
                }
            });
            
            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!partNumberInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                    suggestionsContainer.style.display = 'none';
                }
            });
        }

        // Event listeners for vehicle selection
        document.getElementById('vehicleYear').addEventListener('change', function() {
            const makeSelect = document.getElementById('vehicleMake');
            const modelSelect = document.getElementById('vehicleModel');
            const trimSelect = document.getElementById('vehicleTrim');
            
            if (this.value) {
                makeSelect.disabled = false;
                makeSelect.innerHTML = '<option value="">Select Make</option>';
                modelSelect.disabled = true;
                modelSelect.innerHTML = '<option value="">Select Model</option>';
                trimSelect.disabled = true;
                trimSelect.innerHTML = '<option value="">Select Trim</option>';
                
                const makes = vehicleData.makes[this.value] || [];
                makes.forEach(make => {
                    const option = document.createElement('option');
                    option.value = make;
                    option.textContent = make;
                    makeSelect.appendChild(option);
                });
            } else {
                makeSelect.disabled = true;
                modelSelect.disabled = true;
                trimSelect.disabled = true;
            }
        });

        document.getElementById('vehicleMake').addEventListener('change', function() {
            const modelSelect = document.getElementById('vehicleModel');
            const trimSelect = document.getElementById('vehicleTrim');
            
            if (this.value) {
                modelSelect.disabled = false;
                modelSelect.innerHTML = '<option value="">Select Model</option>';
                trimSelect.disabled = true;
                trimSelect.innerHTML = '<option value="">Select Trim</option>';
                
                const models = vehicleData.models[this.value] || [];
                models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.textContent = model;
                    modelSelect.appendChild(option);
                });
            } else {
                modelSelect.disabled = true;
                trimSelect.disabled = true;
            }
        });

        document.getElementById('vehicleModel').addEventListener('change', function() {
            const trimSelect = document.getElementById('vehicleTrim');
            const customModelGroup = document.getElementById('customModelGroup');
            
            if (this.value === 'custom') {
                customModelGroup.style.display = 'block';
                trimSelect.disabled = true;
            } else {
                customModelGroup.style.display = 'none';
                if (this.value) {
                    trimSelect.disabled = false;
                    trimSelect.innerHTML = '<option value="">Select Trim</option>';
                    
                    const trims = vehicleData.trims[this.value] || [];
                    trims.forEach(trim => {
                        const option = document.createElement('option');
                        option.value = trim;
                        option.textContent = trim;
                        trimSelect.appendChild(option);
                    });
                } else {
                    trimSelect.disabled = true;
                }
            }
        });

        // Form submission
        document.getElementById('compatibilityForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const year = document.getElementById('vehicleYear').value;
            const make = document.getElementById('vehicleMake').value;
            let model = document.getElementById('vehicleModel').value;
            const trim = document.getElementById('vehicleTrim').value;
            const category = document.getElementById('partCategory').value;
            const partNumber = document.getElementById('partNumber').value;
            
            // Handle custom model
            if (model === 'custom') {
                model = document.getElementById('customModel').value;
                if (!model) {
                    showNotification('Please enter a model name', 'error');
                    return;
                }
            }
            
            if (!year || !make || !model || !category) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Save current vehicle
            currentVehicle = { year, make, model, trim };
            
            // Save vehicle if not already saved
            saveVehicle(year, make, model, trim);
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            
            // Simulate API call delay
            setTimeout(() => {
                findCompatibleParts(year, make, model, category, partNumber);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').style.display = 'block';
                
                // Scroll to results
                document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            }, 1500);
        });

        function findCompatibleParts(year, make, model, category, partNumber) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<h3>Compatible Parts for ${year} ${make} ${model}</h3>`;
            
            let parts = [];
            
            // If part number is specified, search by part number
            if (partNumber) {
                // Search all categories for the part number
                Object.keys(partsDatabase).forEach(cat => {
                    partsDatabase[cat].forEach(part => {
                        if (part.number.toLowerCase().includes(partNumber.toLowerCase()) || 
                            part.name.toLowerCase().includes(partNumber.toLowerCase()) ||
                            part.brand.toLowerCase().includes(partNumber.toLowerCase())) {
                            parts.push(part);
                        }
                    });
                });
            } else {
                // Otherwise, show parts from the selected category
                parts = partsDatabase[category] || [];
            }
            
            if (parts.length === 0) {
                resultsDiv.innerHTML += '<p>No compatible parts found. Try a different search.</p>';
                return;
            }
            
            parts.forEach(part => {
                const isCompatible = part.compatibleWith.includes(model);
                
                const partCard = document.createElement('div');
                partCard.className = 'part-card';
                
                let badgeClass = 'compatible';
                let badgeText = 'Direct Fit';
                
                if (part.fit === 'modification') {
                    badgeClass = 'requires-modification';
                    badgeText = 'Modification Required';
                } else if (part.fit === 'not-compatible' || !isCompatible) {
                    badgeClass = 'not-compatible';
                    badgeText = 'Not Compatible';
                }
                
                // Create star rating
                let stars = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= Math.floor(part.rating)) {
                        stars += '<i class="fas fa-star"></i>';
                    } else if (i === Math.ceil(part.rating) && !Number.isInteger(part.rating)) {
                        stars += '<i class="fas fa-star-half-alt"></i>';
                    } else {
                        stars += '<i class="far fa-star"></i>';
                    }
                }
                
                partCard.innerHTML = `
                    <div class="part-image">
                        <i class="fas fa-cog fa-3x"></i>
                    </div>
                    <div class="compatibility-badge ${badgeClass}">${badgeText}</div>
                    <h4>${part.name}</h4>
                    <div class="rating">${stars} <span>${part.rating} (${part.reviews} reviews)</span></div>
                    <div class="part-meta">
                        <span class="meta-item"><i class="fas fa-tag"></i> ${part.brand}</span>
                        <span class="meta-item"><i class="fas fa-hashtag"></i> ${part.number}</span>
                        <span class="meta-item"><i class="fas fa-shield-alt"></i> ${part.warranty}</span>
                    </div>
                    <p>${part.description}</p>
                    <div class="progress-bar">
                        <div class="progress" style="width: ${(part.stock / 100) * 100}%"></div>
                    </div>
                    <div class="part-meta">
                        <span class="meta-item"><i class="fas fa-box"></i> ${part.stock} in stock</span>
                    </div>
                    <div class="price">$${part.price.toFixed(2)}</div>
                    <div class="part-actions">
                        <button class="btn btn-success" onclick="addToCart('${part.number}')">
                            <i class="fas fa-cart-plus"></i> Add to Cart
                        </button>
                        <button class="btn" onclick="viewPartDetails('${part.number}')">
                            <i class="fas fa-info-circle"></i> Details
                        </button>
                        <button class="btn btn-secondary" onclick="savePart('${part.number}')">
                            <i class="far fa-bookmark"></i> Save
                        </button>
                    </div>
                `;
                
                resultsDiv.appendChild(partCard);
            });
        }

        function decodeVIN() {
            const vin = document.getElementById('vinInput').value.trim().toUpperCase();
            if (!vin) {
                showNotification('Please enter a VIN', 'error');
                return;
            }
            
            if (vin.length !== 17) {
                showNotification('VIN must be 17 characters long', 'error');
                return;
            }
            
            // Simple VIN validation and decoding simulation
            let year, make, model, trim;
            
            // Extract year from VIN (10th character)
            const yearChar = vin.charAt(9);
            const yearMap = {
                'L': 2020, 'M': 2021, 'N': 2022, 'P': 2023, 'R': 2024
            };
            year = yearMap[yearChar] || 2022;
            
            // Extract make from VIN (first character)
            const makeChar = vin.charAt(0);
            const makeMap = {
                '1': 'Chevrolet', '2': 'Pontiac', '3': 'Oldsmobile', 
                '4': 'Buick', '5': 'GMC', '6': 'Cadillac',
                'A': 'Audi', 'B': 'BMW', 'H': 'Honda', 
                'J': 'Jeep', 'L': 'Lincoln', 'N': 'Nissan',
                'T': 'Toyota', 'V': 'Volkswagen'
            };
            make = makeMap[makeChar] || 'Honda';
            
            // Simple model detection based on make
            if (make === 'Honda') model = 'Civic';
            else if (make === 'Toyota') model = 'Camry';
            else if (make === 'Ford') model = 'F-150';
            else model = 'Unknown';
            
            // Set trim based on model
            if (model === 'Civic') trim = 'Touring';
            else if (model === 'Camry') trim = 'LE';
            else if (model === 'F-150') trim = 'XLT';
            else trim = 'Base';
            
            document.getElementById('vinResults').style.display = 'block';
            document.getElementById('vinResults').innerHTML = `
                <h4>VIN Decoding Results for ${vin}</h4>
                <div class="part-card">
                    <div class="part-meta">
                        <span class="meta-item"><strong>Year:</strong> ${year}</span>
                        <span class="meta-item"><strong>Make:</strong> ${make}</span>
                        <span class="meta-item"><strong>Model:</strong> ${model}</span>
                        <span class="meta-item"><strong>Trim:</strong> ${trim}</span>
                    </div>
                    <div class="part-meta">
                        <span class="meta-item"><strong>Engine:</strong> 1.5L Turbocharged I4</span>
                        <span class="meta-item"><strong>Transmission:</strong> CVT</span>
                        <span class="meta-item"><strong>Drive Type:</strong> FWD</span>
                    </div>
                    <div class="part-meta">
                        <span class="meta-item"><strong>Manufactured in:</strong> United States</span>
                        <span class="meta-item"><strong>Plant:</strong> Greensburg, IN</span>
                    </div>
                    <button class="btn" style="margin-top: 15px;" onclick="useDecodedVehicle('${year}', '${make}', '${model}', '${trim}')">
                        <i class="fas fa-check"></i> Use This Vehicle
                    </button>
                </div>
            `;
        }

        function useDecodedVehicle(year, make, model, trim) {
            // Prefill the form with the decoded vehicle
            document.getElementById('vehicleYear').value = year;
            document.getElementById('vehicleYear').dispatchEvent(new Event('change'));
            
            setTimeout(() => {
                document.getElementById('vehicleMake').value = make;
                document.getElementById('vehicleMake').dispatchEvent(new Event('change'));
                
                setTimeout(() => {
                    document.getElementById('vehicleModel').value = model;
                    document.getElementById('vehicleModel').dispatchEvent(new Event('change'));
                    
                    setTimeout(() => {
                        if (trim && document.getElementById('vehicleTrim').querySelector(`option[value="${trim}"]`)) {
                            document.getElementById('vehicleTrim').value = trim;
                        }
                    }, 500);
                }, 500);
            }, 500);
            
            // Switch back to part finder tab
            switchTab('compatibility');
            showNotification('Vehicle information loaded successfully', 'success');
        }

        function findCrossReferences() {
            const partNumber = document.getElementById('crossRefPartNumber').value.trim();
            const brand = document.getElementById('crossRefBrand').value.trim();
            
            if (!partNumber) {
                showNotification('Please enter a part number', 'error');
                return;
            }
            
            const results = crossReferenceDB[partNumber] || [];
            
            document.getElementById('crossRefResults').style.display = 'block';
            
            if (results.length === 0) {
                document.getElementById('crossRefResults').innerHTML = `
                    <h4>Cross Reference Results</h4>
                    <p>No equivalent parts found for ${partNumber}.</p>
                `;
                return;
            }
            
            let html = `
                <h4>Cross Reference Results for ${partNumber}</h4>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Brand</th>
                            <th>Part Number</th>
                            <th>Price</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            results.forEach(part => {
                html += `
                    <tr>
                        <td>${part.brand}</td>
                        <td>${part.number}</td>
                        <td>${part.price}</td>
                        <td>
                            <button class="btn" onclick="searchPart('${part.number}')">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            document.getElementById('crossRefResults').innerHTML = html;
        }

        function searchPart(partNumber) {
            // Switch to part finder and search for the part
            switchTab('compatibility');
            document.getElementById('partNumber').value = partNumber;
            document.getElementById('partCategory').value = '';
            
            // Trigger form submission if we have a vehicle selected
            if (currentVehicle) {
                document.getElementById('compatibilityForm').dispatchEvent(new Event('submit'));
            } else {
                showNotification('Please select a vehicle first', 'warning');
            }
        }

        function saveVehicle(year, make, model, trim) {
            const vehicleId = `${year}-${make}-${model}-${trim || 'base'}`;
            
            // Check if vehicle is already saved
            if (savedVehicles.some(v => v.id === vehicleId)) {
                return;
            }
            
            const vehicle = {
                id: vehicleId,
                year: year,
                make: make,
                model: model,
                trim: trim || 'Base',
                savedAt: new Date().toISOString()
            };
            
            savedVehicles.push(vehicle);
            localStorage.setItem('savedVehicles', JSON.stringify(savedVehicles));
            
            // Update the saved vehicles list
            loadSavedVehicles();
            updateMaintenanceVehicleDropdown();
            
            showNotification('Vehicle saved successfully', 'success');
        }

        function loadSavedVehicles() {
            const container = document.getElementById('savedVehiclesList');
            container.innerHTML = '';
            
            if (savedVehicles.length === 0) {
                container.innerHTML = '<p>No vehicles saved yet. Search for parts to save vehicles.</p>';
                return;
            }
            
            savedVehicles.forEach(vehicle => {
                const vehicleEl = document.createElement('div');
                vehicleEl.className = 'saved-vehicle';
                vehicleEl.innerHTML = `
                    <span onclick="loadSavedVehicle('${vehicle.id}')">${vehicle.year} ${vehicle.make} ${vehicle.model} ${vehicle.trim}</span>
                    <i class="fas fa-times" onclick="removeVehicle('${vehicle.id}')"></i>
                `;
                container.appendChild(vehicleEl);
            });
        }

        function loadSavedVehicle(vehicleId) {
            const vehicle = savedVehicles.find(v => v.id === vehicleId);
            if (vehicle) {
                prefillVehicleForm(vehicle.year, vehicle.make, vehicle.model, vehicle.trim);
                switchTab('compatibility');
                showNotification('Vehicle loaded successfully', 'success');
            }
        }

        function removeVehicle(vehicleId) {
            savedVehicles = savedVehicles.filter(v => v.id !== vehicleId);
            localStorage.setItem('savedVehicles', JSON.stringify(savedVehicles));
            loadSavedVehicles();
            updateMaintenanceVehicleDropdown();
            showNotification('Vehicle removed', 'success');
        }

        function updateMaintenanceVehicleDropdown() {
            const dropdown = document.getElementById('maintenanceVehicle');
            dropdown.innerHTML = '<option value="">Select a vehicle</option>';
            
            savedVehicles.forEach(vehicle => {
                const option = document.createElement('option');
                option.value = vehicle.id;
                option.textContent = `${vehicle.year} ${vehicle.make} ${vehicle.model} ${vehicle.trim}`;
                dropdown.appendChild(option);
            });
        }

        function logMaintenance() {
            const vehicleId = document.getElementById('maintenanceVehicle').value;
            const type = document.getElementById('maintenanceType').value;
            const date = document.getElementById('maintenanceDate').value;
            const mileage = document.getElementById('maintenanceMileage').value;
            const cost = document.getElementById('maintenanceCost').value;
            const notes = document.getElementById('maintenanceNotes').value;
            
            if (!vehicleId || !type || !date || !mileage) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const maintenance = {
                id: Date.now().toString(),
                vehicleId: vehicleId,
                type: type,
                date: date,
                mileage: parseInt(mileage),
                cost: cost ? parseFloat(cost) : 0,
                notes: notes,
                loggedAt: new Date().toISOString()
            };
            
            maintenanceLogs.push(maintenance);
            localStorage.setItem('maintenanceLogs', JSON.stringify(maintenanceLogs));
            
            // Clear form
            document.getElementById('maintenanceDate').valueAsDate = new Date();
            document.getElementById('maintenanceMileage').value = '';
            document.getElementById('maintenanceCost').value = '';
            document.getElementById('maintenanceNotes').value = '';
            
            showNotification('Maintenance logged successfully', 'success');
        }

        function loadMaintenanceHistory() {
            const container = document.getElementById('maintenanceHistoryList');
            container.innerHTML = '';
            
            if (maintenanceLogs.length === 0) {
                container.innerHTML = '<p>No maintenance history found.</p>';
                return;
            }
            
            // Group maintenance by vehicle
            const maintenanceByVehicle = {};
            maintenanceLogs.forEach(log => {
                if (!maintenanceByVehicle[log.vehicleId]) {
                    maintenanceByVehicle[log.vehicleId] = [];
                }
                maintenanceByVehicle[log.vehicleId].push(log);
            });
            
            // Display maintenance for each vehicle
            Object.keys(maintenanceByVehicle).forEach(vehicleId => {
                const vehicle = savedVehicles.find(v => v.id === vehicleId);
                if (vehicle) {
                    const vehicleHeader = document.createElement('h4');
                    vehicleHeader.textContent = `${vehicle.year} ${vehicle.make} ${vehicle.model} ${vehicle.trim}`;
                    container.appendChild(vehicleHeader);
                    
                    maintenanceByVehicle[vehicleId]
                        .sort((a, b) => new Date(b.date) - new Date(a.date))
                        .forEach(log => {
                            const maintenanceItem = document.createElement('div');
                            maintenanceItem.className = 'maintenance-item';
                            
                            const typeNames = {
                                'oil': 'Oil Change',
                                'tire': 'Tire Rotation',
                                'brake': 'Brake Service',
                                'filter': 'Filter Replacement',
                                'inspection': 'Inspection',
                                'other': 'Other Service'
                            };
                            
                            maintenanceItem.innerHTML = `
                                <div class="part-meta">
                                    <span class="meta-item"><strong>${typeNames[log.type]}</strong></span>
                                    <span class="meta-item"><i class="fas fa-calendar"></i> ${new Date(log.date).toLocaleDateString()}</span>
                                    <span class="meta-item"><i class="fas fa-tachometer-alt"></i> ${log.mileage.toLocaleString()} miles</span>
                                    ${log.cost ? `<span class="meta-item"><i class="fas fa-dollar-sign"></i> $${log.cost.toFixed(2)}</span>` : ''}
                                </div>
                                ${log.notes ? `<p><em>${log.notes}</em></p>` : ''}
                            `;
                            container.appendChild(maintenanceItem);
                        });
                }
            });
        }

        function loadUpcomingServices() {
            const container = document.getElementById('upcomingServicesList');
            container.innerHTML = '';
            
            if (maintenanceLogs.length === 0) {
                container.innerHTML = '<p>No maintenance data available for upcoming services prediction.</p>';
                return;
            }
            
            // Simple upcoming services calculation
            const now = new Date();
            const upcomingServices = [];
            
            savedVehicles.forEach(vehicle => {
                const vehicleMaintenance = maintenanceLogs
                    .filter(log => log.vehicleId === vehicle.id)
                    .sort((a, b) => new Date(b.date) - new Date(a.date));
                
                if (vehicleMaintenance.length > 0) {
                    const lastService = vehicleMaintenance[0];
                    const nextOilChange = {
                        vehicle: vehicle,
                        type: 'Oil Change',
                        dueDate: new Date(lastService.date),
                        dueMileage: lastService.mileage + 5000,
                        estimatedDate: new Date(now.getTime() + 90 * 24 * 60 * 60 * 1000) // 90 days from now
                    };
                    nextOilChange.dueDate.setMonth(nextOilChange.dueDate.getMonth() + 6);
                    
                    upcomingServices.push(nextOilChange);
                }
            });
            
            if (upcomingServices.length === 0) {
                container.innerHTML = '<p>No upcoming services predicted.</p>';
                return;
            }
            
            upcomingServices.forEach(service => {
                const serviceItem = document.createElement('div');
                serviceItem.className = 'maintenance-item';
                serviceItem.innerHTML = `
                    <h4>${service.vehicle.year} ${service.vehicle.make} ${service.vehicle.model}</h4>
                    <div class="part-meta">
                        <span class="meta-item"><strong>${service.type}</strong></span>
                        <span class="meta-item"><i class="fas fa-calendar"></i> Due around: ${service.estimatedDate.toLocaleDateString()}</span>
                        <span class="meta-item"><i class="fas fa-tachometer-alt"></i> Around ${service.dueMileage.toLocaleString()} miles</span>
                    </div>
                    <button class="btn" style="margin-top: 10px;" onclick="scheduleReminder('${service.vehicle.id}', '${service.type}')">
                        <i class="fas fa-bell"></i> Set Reminder
                    </button>
                `;
                container.appendChild(serviceItem);
            });
        }

        function scheduleReminder(vehicleId, serviceType) {
            showNotification(`Reminder set for ${serviceType}`, 'success');
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
            
            // Populate years in add vehicle modal
            if (modalId === 'addVehicleModal') {
                const yearSelect = document.getElementById('newVehicleYear');
                yearSelect.innerHTML = '<option value="">Select Year</option>';
                vehicleData.years.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearSelect.appendChild(option);
                });
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function saveNewVehicle() {
            const year = document.getElementById('newVehicleYear').value;
            const make = document.getElementById('newVehicleMake').value;
            const model = document.getElementById('newVehicleModel').value;
            const trim = document.getElementById('newVehicleTrim').value;
            
            if (!year || !make || !model) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            saveVehicle(year, make, model, trim);
            closeModal('addVehicleModal');
        }

        function prefillVehicleForm(year, make, model, trim = '') {
            document.getElementById('vehicleYear').value = year;
            document.getElementById('vehicleYear').dispatchEvent(new Event('change'));
            
            setTimeout(() => {
                document.getElementById('vehicleMake').value = make;
                document.getElementById('vehicleMake').dispatchEvent(new Event('change'));
                
                setTimeout(() => {
                    document.getElementById('vehicleModel').value = model;
                    document.getElementById('vehicleModel').dispatchEvent(new Event('change'));
                    
                    setTimeout(() => {
                        if (trim && document.getElementById('vehicleTrim').querySelector(`option[value="${trim}"]`)) {
                            document.getElementById('vehicleTrim').value = trim;
                        }
                    }, 500);
                }, 500);
            }, 500);
        }

        function addToCart(partNumber) {
            // Find the part in the database
            let partToAdd = null;
            Object.keys(partsDatabase).forEach(category => {
                const part = partsDatabase[category].find(p => p.number === partNumber);
                if (part) {
                    partToAdd = { ...part, category: category };
                }
            });
            
            if (partToAdd) {
                // Check if part is already in cart
                const existingItem = shoppingCart.find(item => item.number === partNumber);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    shoppingCart.push({
                        ...partToAdd,
                        quantity: 1,
                        addedAt: new Date().toISOString()
                    });
                }
                
                localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
                updateCartCount();
                showNotification(`Added ${partToAdd.name} to cart`, 'success');
            }
        }

        function updateCartCount() {
            const cartCount = shoppingCart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCount').textContent = cartCount;
        }

        function viewCart() {
            showModal('cartModal');
            updateCartDisplay();
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            
            if (shoppingCart.length === 0) {
                cartItems.innerHTML = '<p>Your cart is empty.</p>';
                cartTotal.textContent = 'Total: $0.00';
                return;
            }
            
            let total = 0;
            
            shoppingCart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div>
                        <strong>${item.name}</strong><br>
                        <small>${item.brand} - ${item.number}</small><br>
                        <small>$${item.price.toFixed(2)} each</small>
                    </div>
                    <div style="text-align: right;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                            <button class="btn btn-secondary" onclick="updateCartQuantity(${index}, -1)" style="padding: 5px 10px;">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span>${item.quantity}</span>
                            <button class="btn btn-secondary" onclick="updateCartQuantity(${index}, 1)" style="padding: 5px 10px;">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <strong>$${itemTotal.toFixed(2)}</strong><br>
                        <button class="btn btn-danger" onclick="removeFromCart(${index})" style="padding: 5px 10px; margin-top: 5px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });
            
            cartTotal.textContent = `Total: $${total.toFixed(2)}`;
        }

        function updateCartQuantity(index, change) {
            const item = shoppingCart[index];
            item.quantity += change;
            
            if (item.quantity <= 0) {
                shoppingCart.splice(index, 1);
            }
            
            localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
            updateCartCount();
            updateCartDisplay();
        }

        function removeFromCart(index) {
            shoppingCart.splice(index, 1);
            localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
            updateCartCount();
            updateCartDisplay();
            showNotification('Item removed from cart', 'success');
        }

        function checkout() {
            if (shoppingCart.length === 0) {
                showNotification('Your cart is empty', 'warning');
                return;
            }
            
            showNotification('Proceeding to checkout...', 'success');
            // In a real application, this would redirect to a checkout page
            setTimeout(() => {
                shoppingCart = [];
                localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
                updateCartCount();
                closeModal('cartModal');
                showNotification('Order placed successfully!', 'success');
            }, 2000);
        }

        function viewPartDetails(partNumber) {
            // Find the part in the database
            let partDetails = null;
            Object.keys(partsDatabase).forEach(category => {
                const part = partsDatabase[category].find(p => p.number === partNumber);
                if (part) {
                    partDetails = part;
                }
            });
            
            if (partDetails) {
                document.getElementById('partDetailsTitle').innerHTML = `<i class="fas fa-info-circle"></i> ${partDetails.name}`;
                
                let specificationsHtml = '';
                if (partDetails.specifications) {
                    specificationsHtml = '<h4>Specifications</h4><ul style="margin-left: 20px;">';
                    for (const [key, value] of Object.entries(partDetails.specifications)) {
                        specificationsHtml += `<li><strong>${key}:</strong> ${value}</li>`;
                    }
                    specificationsHtml += '</ul>';
                }
                
                document.getElementById('partDetailsContent').innerHTML = `
                    <div class="part-meta">
                        <span class="meta-item"><i class="fas fa-tag"></i> ${partDetails.brand}</span>
                        <span class="meta-item"><i class="fas fa-hashtag"></i> ${partDetails.number}</span>
                        <span class="meta-item"><i class="fas fa-shield-alt"></i> ${partDetails.warranty}</span>
                    </div>
                    <p>${partDetails.description}</p>
                    ${specificationsHtml}
                    <div class="price" style="font-size: 1.6rem; margin: 20px 0;">$${partDetails.price.toFixed(2)}</div>
                    <div class="part-meta">
                        <span class="meta-item"><i class="fas fa-box"></i> ${partDetails.stock} in stock</span>
                        <span class="meta-item"><i class="fas fa-star"></i> ${partDetails.rating} rating (${partDetails.reviews} reviews)</span>
                    </div>
                `;
                
                // Update add to cart button to use this part
                document.getElementById('addToCartFromDetails').onclick = function() {
                    addToCart(partNumber);
                    closeModal('partDetailsModal');
                };
                
                showModal('partDetailsModal');
            }
        }

        function savePart(partNumber) {
            showNotification(`Part ${partNumber} saved to your favorites`, 'success');
        }

        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Login/Register button handlers
        document.getElementById('loginBtn').addEventListener('click', function() {
            showNotification('Login functionality would be implemented here', 'warning');
        });

        document.getElementById('registerBtn').addEventListener('click', function() {
            showNotification('Registration functionality would be implemented here', 'warning');
        });

        // Cart button handler
        document.getElementById('cartBtn').addEventListener('click', viewCart);

        // Close modals when clicking outside
        window.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
